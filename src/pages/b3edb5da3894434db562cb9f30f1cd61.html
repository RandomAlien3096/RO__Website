<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>e32a82fd0b86476e98c37a8d56ff8db4</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="telstra-network-disruption" class="cell markdown">
<h1>Telstra Network Disruption</h1>
<hr />
<p>Ing. Rafael Oliva</p>
<p>Guatemala, 27 de Octubre de 2022</p>
</section>
<section id="entendimiento-de-negocio" class="cell markdown">
<h3>Entendimiento de Negocio</h3>
<hr />
<p>El objetivo de este problema es poder predecir en la red de TELSTRA
la severidad de la falla en un momento dado en una ubicacion en
particular con una "llave" (id key). Estas predicciones son basadas en
los datos disponibles en nuestros archivos.</p>
<p>En esta situacion, se categorizo la severidad de las fallas en tres
categorias;</p>
<ul>
<li>0 (No hay falla)</li>
<li>1 (Pocas fallas)</li>
<li>2 (Multiples fallas)</li>
</ul>
<p>Asi que, dado el problema proporsionado por TELSTRA, debemos de
plantearnos las siguientes preguntas:</p>
<ul>
<li>La severidad de las fallas atravez de la red, estan directamente
relacionadas con la ubicacion?</li>
<li>Se podra predecir la ubicacion de la falla dada la base de datos
proporcionada?</li>
<li>Como podemos medir nuestro valor de exito dentro del proyecto?</li>
</ul>
</section>
<section id="entendimiento-de-datos-y-procesamiento-de-datos"
class="cell markdown">
<h3>Entendimiento de Datos y Procesamiento de Datos</h3>
<hr />
<p>El conjunto de datos fue creado a partir de 6 reportes de tipos de
fallas severidad de fallas y mas. Estos reportes representan el
historial mas reciente de fallas y la ubicacion de las mismas alrededor
de la red de comunicacion de la empresa Telstra. Para poder avanzar en
la creacion de modelos de prediccion primero se debe determinar que
caracteristicas son las mas relevantes en todo este conjuto de
informacion proporcionada. Para ello realizaremos una analisis
exploratorio de datos inicial. Esto es para tener un inicio para el
plantamiento de la hipotesis inicial.</p>
<p>Ahora preprocesaremos los datos donde lograremos tener una mejor idea
de la calidad de datos que se tiene y el tipo de datos con que se
trabajara</p>
</section>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Seccion de importacion de librerias utilizadas en el transcurso del proyecto</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">&#39;figure.dpi&#39;</span>]<span class="op">=</span> <span class="dv">300</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> catboost <span class="im">import</span> CatBoostClassifier, Pool</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">&quot;whitegrid&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------Cargando conjuto de datos------------------</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>datadir <span class="op">=</span> <span class="st">&#39;data&#39;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> str_to_num(string):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(string.split(<span class="st">&quot; &quot;</span>)[<span class="dv">1</span>])    <span class="co">#after the split returns the num on the string</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#loading test.csv file</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">&#39;test.csv&#39;</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                   converters <span class="op">=</span> {<span class="st">&#39;location&#39;</span>:str_to_num})</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#loading train.csv file</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">&#39;train.csv&#39;</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                   converters <span class="op">=</span> {<span class="st">&#39;location&#39;</span>:str_to_num})</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#loading event_type.csv file</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>event_type <span class="op">=</span> pd.read_csv(<span class="st">&#39;event_type.csv&#39;</span>, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                         converters <span class="op">=</span> {<span class="st">&#39;event_type&#39;</span>:str_to_num})</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#loading log_feature.csv file</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>log_failure <span class="op">=</span> pd.read_csv(<span class="st">&#39;log_feature.csv&#39;</span>, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                          converters <span class="op">=</span> {<span class="st">&#39;log_feature&#39;</span>:str_to_num})</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#loading resource_type.csv file</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>resource_type <span class="op">=</span> pd.read_csv(<span class="st">&#39;resource_type.csv&#39;</span>, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                            converters <span class="op">=</span> {<span class="st">&#39;resource_type&#39;</span>:str_to_num})</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#loading severity_type.csv file</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>severity_type <span class="op">=</span> pd.read_csv(<span class="st">&#39;severity_type.csv&#39;</span>, </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                            index_col <span class="op">=</span> <span class="st">&#39;id&#39;</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                            converters <span class="op">=</span> {<span class="st">&#39;severity_type&#39;</span>:str_to_num})</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------Printing the shape of each data set------------------</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the test data set is: </span><span class="sc">{}</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>(test.shape))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the train data set is: </span><span class="sc">{}</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>(train.shape))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the events data set is: </span><span class="sc">{}</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>(event_type.shape))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the log feautures data set is: </span><span class="sc">{}</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>(log_failure.shape))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the resource data set is: </span><span class="sc">{}</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>(resource_type.shape))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the severity type data set is: </span><span class="sc">{}</span><span class="ch">\n</span><span class="st">&quot;</span>.<span class="bu">format</span>(severity_type.shape))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Headers of train data set&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>train.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The size of the test data set is: (11171, 2)

The size of the train data set is: (7381, 3)

The size of the events data set is: (31170, 2)

The size of the log feautures data set is: (58671, 3)

The size of the resource data set is: (21076, 2)

The size of the severity type data set is: (18552, 1)

Headers of train data set
</code></pre>
</div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>location</th>
      <th>fault_severity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14121</td>
      <td>118</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9320</td>
      <td>91</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14394</td>
      <td>152</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8218</td>
      <td>931</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14804</td>
      <td>120</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Revisando los headers del conjunto de datos de test</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Headers of test data set&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>test.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Headers of test data set
</code></pre>
</div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11066</td>
      <td>481</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18000</td>
      <td>962</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16964</td>
      <td>491</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4795</td>
      <td>532</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3392</td>
      <td>600</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>Uniremos los conjuntos de datos a excepcion de test.csv para poder
procesarlos en conjunto y tenerlos en una sola tabla.</p>
</div>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>train_1 <span class="op">=</span> train.merge(severity_type, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>train_2 <span class="op">=</span> train_1.merge(resource_type, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>train_3 <span class="op">=</span> train_2.merge(log_failure, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>train_4 <span class="op">=</span> train_3.merge(event_type, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#checking the head after merging</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the train dataset is: </span><span class="sc">{}</span><span class="st"> &quot;</span>.<span class="bu">format</span>(train_4.shape))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Deleting duplicates in data set...&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>train_4.drop_duplicates(subset<span class="op">=</span> <span class="st">&#39;id&#39;</span>, keep<span class="op">=</span> <span class="st">&#39;first&#39;</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#checking the shape of training file after dropping duplicate records</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The size of the train dataset is now: </span><span class="sc">{}</span><span class="st"> &quot;</span>.<span class="bu">format</span>(train_4.shape))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>train_4.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The size of the train dataset is: (61839, 8) 
Deleting duplicates in data set...
The size of the train dataset is now: (7381, 8) 
</code></pre>
</div>
<div class="output execute_result" data-execution_count="5">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>location</th>
      <th>fault_severity</th>
      <th>severity_type</th>
      <th>resource_type</th>
      <th>log_feature</th>
      <th>volume</th>
      <th>event_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14121</td>
      <td>118</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>312</td>
      <td>19</td>
      <td>34</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9320</td>
      <td>91</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>315</td>
      <td>200</td>
      <td>34</td>
    </tr>
    <tr>
      <th>8</th>
      <td>14394</td>
      <td>152</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>221</td>
      <td>1</td>
      <td>35</td>
    </tr>
    <tr>
      <th>12</th>
      <td>8218</td>
      <td>931</td>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>80</td>
      <td>9</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>14804</td>
      <td>120</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>134</td>
      <td>1</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>Ahora que ya tenemos todos nuestros datos en un solo lugar, podemos
iniciar visualizando nuestros datos para ver, tentativamente, las
tendencias del comportamiento de los mismos.</p>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ilustrando la cantidad de fallas en train dataset de cada tipo</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(train_4[<span class="st">&#39;fault_severity&#39;</span>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> ax.patches:</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    ax.annotate(<span class="st">&#39;</span><span class="sc">{:.1f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(i.get_height()), (i.get_x()<span class="op">+</span> <span class="fl">0.25</span>, i.get_height() <span class="op">+</span> <span class="fl">0.1</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Count of fault_severity&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_b3edb5da3894434db562cb9f30f1cd61/74810c71492954977f87141d3b1f76ffc000a49d.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Este conjuto de datos, nos permite ver que, como lo esperado en la
red de comunicacion de TELSTRA, la mayoria de localidades no tienen
falla alguna. Pero si se tiene un numero alarmante de fallas y
localidades que se tienen numerosas fallas.</p>
<p>Ahorita utilizaremos una matriz de correlacion. Esto nos servira en
poder visualizar y ver puntualmente, si existen relaciones y sobre que
relaciones existen.</p>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting a heat map of the fault severity</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(train_4.corr(), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            vmax <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            linewidths<span class="op">=</span> <span class="fl">0.01</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span> <span class="va">True</span>, annot<span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            cmap<span class="op">=</span> <span class="st">&#39;viridis&#39;</span>, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            linecolor<span class="op">=</span> <span class="st">&#39;white&#39;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Heatmap of Fault Serveity Data&quot;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_b3edb5da3894434db562cb9f30f1cd61/9eea33cd62d4dfb7e1bc446d5bfc2ae99bdc0d0b.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>En la grafica de calor (heatmap), podemos observar los indices de
correlacion entre cada una de las variables. Donde 1 es que son
directamente proporcionales; es decir, si uno incrementa, el otro igual
incrementa. Y donde -1 es que las variables son inversamente
proporcionales.</p>
<p>Ahora bien, se denota a simple vista unas relaciones claves conforme
a la ubicaion para nuestro analisis:</p>
<ul>
<li>Location v fault_severity</li>
<li>location v severity_type</li>
</ul>
<p>Ahora, despues de nuestra matriz de correlacion procederemos a
investigar visualmente un poco mas sobre la relevancia que tiene la
ubicacion sobre el tipo de fallas que se encuentran. Para ello,
utilizaremos una grafica de dispersion para visualizar la ubicacion de
cada falla respecto a la informacion que se tiene.</p>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loading test.csv file</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>test_plot <span class="op">=</span> pd.read_csv(<span class="st">&#39;test.csv&#39;</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                        index_col <span class="op">=</span> <span class="st">&#39;id&#39;</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                        converters <span class="op">=</span> {<span class="st">&#39;location&#39;</span>:str_to_num})</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#loading train.csv file</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>train_plot <span class="op">=</span> pd.read_csv(<span class="st">&#39;train.csv&#39;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                         index_col <span class="op">=</span> <span class="st">&#39;id&#39;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                         converters <span class="op">=</span> {<span class="st">&#39;location&#39;</span>:str_to_num})</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> train_plot.append(test_plot)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">15</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Scatter plot Location v ID&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(df.loc[df.fault_severity.isnull(),<span class="st">&#39;location&#39;</span>],</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>           df.loc[df.fault_severity.isnull()].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;k&#39;</span>, s<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>ax.scatter(df.loc[df.fault_severity<span class="op">==</span><span class="dv">0</span>,<span class="st">&#39;location&#39;</span>],</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>           df.loc[df.fault_severity<span class="op">==</span><span class="dv">0</span>].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>ax.scatter(df.loc[df.fault_severity<span class="op">==</span><span class="dv">1</span>,<span class="st">&#39;location&#39;</span>],</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>           df.loc[df.fault_severity<span class="op">==</span><span class="dv">1</span>].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>ax.scatter(df.loc[df.fault_severity<span class="op">==</span><span class="dv">2</span>,<span class="st">&#39;location&#39;</span>], </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>           df.loc[df.fault_severity<span class="op">==</span><span class="dv">2</span>].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlim((<span class="op">-</span><span class="dv">20</span>,<span class="dv">1150</span>))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="dv">0</span>,<span class="dv">19000</span>))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Location&#39;</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;ID&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_b3edb5da3894434db562cb9f30f1cd61/729dc581b8ec07a2d0a4bf65bc31e0ca984f41d8.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Ya vista la grafica de dispersion, podemos notar una tendencia. Entre
mayor sea el numero de la ubicacion, las fallas se hacen mas propensas y
aumentan su severidad. Se puede asumir que, entre mayor sea el numero de
la ubicacion, esta se encontra mas lejos. Y que por igual, que cada uno
de las ubicaciones, dependiendo de su numero, se encuentran en orden y
en cercania relativa al valor dado. A partir de ello, podemos plantear
una hipotesis con nuestra matriz de correlacion; La severidad y cantidad
de las fallas en la red de TELSTRA sera directamente proporcional a la
ubicacion y distancia que estas tengan.</p>
</div>
<section id="modelado" class="cell markdown">
<h2>Modelado</h2>
<hr />
</section>
<div class="cell markdown">
<p>Debido a la naturalidad categorica de nuestro complejo de datos, es
necesario, ya sea, procesar profundamente nuestro set de datos o
utilizar un algoritmo de machine learning capaz de poder procesar esta
informacion. Dado esto, se propuso utilizar el algoritmo open-source
llamado "CatBoost". El cual es un algoritmo bastante versatil y
flexible. Donde tiene la capacidad de manejar una gran variedad de tipo
de datos sin ningun problema proveyendo soluciones fuera de lo
convencional para apoyar con los problemas dados comunmente en el
analisis de negocios y big data.</p>
<p>El objetivo ahora sera desplegar el algoritmo CatBoost de forma
correcta. Para ello, nececitamos iniciar con el entrenamiento
supervisado del complejo de datos ya procesado. Con ello utilizaremos el
complejo de datos "train" donde utilizaremos el 75% de sus datos para
entrenar al algoritmo y el 25% seran utilizados para validar el
entrenamiento y simular a su vez como este se comportara si es dado un
set de datos no antes vistos.</p>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Splitting X(data in array) and y (index of data used)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> train_4[[<span class="st">&#39;id&#39;</span>, <span class="st">&#39;location&#39;</span>, <span class="st">&#39;severity_type&#39;</span>, <span class="st">&#39;resource_type&#39;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;log_feature&#39;</span>, <span class="st">&#39;volume&#39;</span>, <span class="st">&#39;event_type&#39;</span>]]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> train_4.fault_severity</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#divide the training set into train/validation set with 25% set aside for validation. </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">101</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Ahora, actualizaremos los parametros del algoritmo para poder hacer
uso de la naturaleza categorica del mismo y utilizarlo en su mejor
capacidad para mejores resultados.</p>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>categorical_features_indices <span class="op">=</span> np.where(X_train.dtypes <span class="op">==</span> <span class="bu">object</span>)[<span class="dv">0</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#using pool to make the training and validation sets</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> Pool(data<span class="op">=</span>X_train,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                     label<span class="op">=</span>y_train,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                     cat_features<span class="op">=</span>categorical_features_indices)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>eval_dataset <span class="op">=</span> Pool(data<span class="op">=</span>X_test,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                    label<span class="op">=</span>y_test,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                    cat_features<span class="op">=</span>categorical_features_indices)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize the catboost classifier</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> CatBoostClassifier(iterations<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                           learning_rate<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                           depth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                           loss_function<span class="op">=</span><span class="st">&#39;MultiClass&#39;</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                           random_seed<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                           bagging_temperature<span class="op">=</span><span class="dv">22</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                           od_type<span class="op">=</span><span class="st">&#39;Iter&#39;</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                           metric_period<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                           od_wait<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit model</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>model.fit(train_dataset, eval_set<span class="op">=</span> eval_dataset, plot<span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb16"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;585d47b456fa495a84db27473ccdeb72&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output stream stderr">
<pre><code>Warning: Overfitting detector is active, thus evaluation metric is calculated on every iteration. &#39;metric_period&#39; is ignored for evaluation metric.
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>0:	learn: 0.8097011	test: 0.8232279	best: 0.8232279 (0)	total: 98.8ms	remaining: 1m 38s
50:	learn: 0.6891822	test: 0.7014301	best: 0.7011246 (48)	total: 164ms	remaining: 3.05s
100:	learn: 0.6651755	test: 0.6883462	best: 0.6883462 (100)	total: 224ms	remaining: 1.99s
150:	learn: 0.6478698	test: 0.6820732	best: 0.6796182 (146)	total: 282ms	remaining: 1.58s
200:	learn: 0.6357514	test: 0.6749089	best: 0.6735488 (193)	total: 340ms	remaining: 1.35s
250:	learn: 0.6246436	test: 0.6744368	best: 0.6735488 (193)	total: 402ms	remaining: 1.2s
300:	learn: 0.6168495	test: 0.6715840	best: 0.6712311 (299)	total: 465ms	remaining: 1.08s
350:	learn: 0.6057613	test: 0.6733312	best: 0.6697978 (332)	total: 525ms	remaining: 971ms
400:	learn: 0.5983205	test: 0.6720923	best: 0.6697978 (332)	total: 586ms	remaining: 875ms
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.6697978062
bestIteration = 332

Shrink model to first 333 iterations.
</code></pre>
</div>
<div class="output execute_result" data-execution_count="12">
<pre><code>&lt;catboost.core.CatBoostClassifier at 0x2b7343dfd00&gt;</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Incialmente, a nuestro modelo, se le indico que entrenara con 1000
iteraciones. Pero luego de 400 iteraciones, como marca arriba, este tuvo
overfitting. Por lo cual, recorto el modelo a solo 333 iteraciones.</p>
<p>Ahora que tenemos nuestro modelo ya entrenado, utilizaremos la
funcion predict() para poder predecir los valores con el conjunto de
datos de validacion que en este caso, sera el 25% de valores de nuestro
train.csv Mientras que nuestra funcion predict_proba() nos dara la
probabilidad de cada uno de los puntos dados.</p>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predicts the actual label or class over the evaluation data set (gives us the final choice)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>preds_class <span class="op">=</span> model.predict(eval_dataset) </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#get predicted probabilities for each class (gives us the probabilities of each choice option that it had)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>preds_proba <span class="op">=</span> model.predict_proba(eval_dataset)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Probabilities of each Label&#39;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(preds_proba)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Probabilities of each Label
[[6.34695909e-01 3.42714092e-01 2.25899984e-02]
 [8.30100770e-01 1.42077653e-01 2.78215777e-02]
 [4.01349383e-01 1.49938543e-01 4.48712074e-01]
 ...
 [3.20211371e-01 8.93100493e-02 5.90478580e-01]
 [9.06275128e-01 9.34559188e-02 2.68953024e-04]
 [3.85959137e-01 2.72217943e-01 3.41822920e-01]]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Ya que tenemos nuestro modelo entrenado y evaluado, es hora de
implementar este a nuestro archivo test.cvs. Esto para poder predecir la
severidad de las fallas dependiendo de la ubicacion. Crearemos nuestro
conjunto de datos de test.csv</p>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The shape of the test data set without merging is: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(test.shape))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>test_1 <span class="op">=</span> test.merge(severity_type, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>test_2 <span class="op">=</span> test_1.merge(resource_type, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>test_3 <span class="op">=</span> test_2.merge(log_failure, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>test_4 <span class="op">=</span> test_3.merge(event_type, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>, left_on<span class="op">=</span><span class="st">&#39;id&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;id&#39;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#removing the duplicates.</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>test_4.drop_duplicates(subset<span class="op">=</span> <span class="st">&#39;id&#39;</span>, keep<span class="op">=</span> <span class="st">&#39;first&#39;</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#checking for any null values. </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>test_4.isnull().<span class="bu">sum</span>()</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The shape of the merged test dataset is: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(test_4.shape))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The shape of the test data set without merging is: (11171, 2)
The shape of the merged test dataset is: (11171, 7)
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Ahora utilizaremos el modelo en el nuevo conjunto de datos para poder
predecir la severidad de fallas y en donde estas sucederan.</p>
</div>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>predict_class <span class="op">=</span> model.predict(test_4)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>prediction_class_df <span class="op">=</span> pd.DataFrame(predict_class, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                   columns <span class="op">=</span> [<span class="st">&#39;fault_severity&#39;</span>])</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>prediction_catboost <span class="op">=</span> pd.concat([test[[<span class="st">&#39;id&#39;</span>,<span class="st">&#39;location&#39;</span>]], prediction_class_df],axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>prediction_catboost.to_csv(<span class="st">&#39;prediction.csv&#39;</span>, index <span class="op">=</span> <span class="va">False</span>, header <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>prediction_catboost.head(<span class="dv">15</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>location</th>
      <th>fault_severity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11066</td>
      <td>481</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18000</td>
      <td>962</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16964</td>
      <td>491</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4795</td>
      <td>532</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3392</td>
      <td>600</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3795</td>
      <td>794</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2881</td>
      <td>375</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1903</td>
      <td>638</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5245</td>
      <td>690</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6726</td>
      <td>893</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1311</td>
      <td>418</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>15795</td>
      <td>320</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>4315</td>
      <td>1013</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>3393</td>
      <td>931</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>6764</td>
      <td>707</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>predict_test <span class="op">=</span> model.predict_proba(test_4) <span class="co">#using the trained catboost model to get the probabilities of the choices</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The shape of the prediction test dataset is now: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(predict_test.shape))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>pred_df <span class="op">=</span> pd.DataFrame(predict_test, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                       columns <span class="op">=</span> [<span class="st">&#39;predict_0&#39;</span>,<span class="st">&#39;predict_1&#39;</span>, <span class="st">&#39;predict_2&#39;</span>])</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The shape of the prediction data frame is now: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(pred_df.shape))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>submission_cat <span class="op">=</span> pd.concat([test[[<span class="st">&#39;id&#39;</span>]],pred_df],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>submission_cat.to_csv(<span class="st">&#39;sub_cat_1.csv&#39;</span>,index<span class="op">=</span><span class="va">False</span>,header<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>submission_cat.head(<span class="dv">15</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The shape of the prediction test dataset is now: (11171, 3)
The shape of the prediction data frame is now: (11171, 3)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="16">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>predict_0</th>
      <th>predict_1</th>
      <th>predict_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11066</td>
      <td>0.994028</td>
      <td>0.004516</td>
      <td>0.001456</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18000</td>
      <td>0.321017</td>
      <td>0.174778</td>
      <td>0.504204</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16964</td>
      <td>0.986801</td>
      <td>0.010605</td>
      <td>0.002594</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4795</td>
      <td>0.851619</td>
      <td>0.147910</td>
      <td>0.000471</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3392</td>
      <td>0.632463</td>
      <td>0.145794</td>
      <td>0.221744</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3795</td>
      <td>0.563807</td>
      <td>0.390033</td>
      <td>0.046161</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2881</td>
      <td>0.797273</td>
      <td>0.202510</td>
      <td>0.000216</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1903</td>
      <td>0.615593</td>
      <td>0.061395</td>
      <td>0.323012</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5245</td>
      <td>0.737178</td>
      <td>0.238249</td>
      <td>0.024573</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6726</td>
      <td>0.870761</td>
      <td>0.129025</td>
      <td>0.000214</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1311</td>
      <td>0.556050</td>
      <td>0.443908</td>
      <td>0.000042</td>
    </tr>
    <tr>
      <th>11</th>
      <td>15795</td>
      <td>0.690187</td>
      <td>0.309802</td>
      <td>0.000011</td>
    </tr>
    <tr>
      <th>12</th>
      <td>4315</td>
      <td>0.763102</td>
      <td>0.171295</td>
      <td>0.065602</td>
    </tr>
    <tr>
      <th>13</th>
      <td>3393</td>
      <td>0.484671</td>
      <td>0.351055</td>
      <td>0.164274</td>
    </tr>
    <tr>
      <th>14</th>
      <td>6764</td>
      <td>0.615090</td>
      <td>0.383304</td>
      <td>0.001606</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="evaluacion" class="cell markdown">
<h2>Evaluacion</h2>
<hr />
</section>
<div class="cell markdown">
<p>Apartir del archivo creado se subio a kaggle para obtener una
puntuacion para la evaluacion requerida solo para terminos de esta
activad. En este caso el resultado con nuestro modelo con el algoritmo
CatBoost fue el siguiente:</p>
</div>
<div class="cell markdown">
<p><img
src="vertopal_b3edb5da3894434db562cb9f30f1cd61/Kaggle_Telstra_SC.png"
alt="Kaggle_Telstra_SC.png" /></p>
</div>
<div class="cell markdown">
<p>Luego de esto podemos visualizar los resultados finales en la grafica
de dispersion donde se puede apreciar los datos resultantes del archivo
generado en csv.</p>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loading test.csv file</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>prediction_plot <span class="op">=</span> pd.read_csv(<span class="st">&#39;prediction.csv&#39;</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                        index_col <span class="op">=</span> <span class="st">&#39;id&#39;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">15</span>))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Scatter plot Location v ID&quot;</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>ax.scatter(prediction_catboost.loc[prediction_catboost.fault_severity.isnull(),<span class="st">&#39;location&#39;</span>],</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>           prediction_catboost.loc[prediction_catboost.fault_severity.isnull()].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;k&#39;</span>, s<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>ax.scatter(prediction_catboost.loc[prediction_catboost.fault_severity<span class="op">==</span><span class="dv">0</span>,<span class="st">&#39;location&#39;</span>],</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>           prediction_catboost.loc[prediction_catboost.fault_severity<span class="op">==</span><span class="dv">0</span>].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>ax.scatter(prediction_catboost.loc[prediction_catboost.fault_severity<span class="op">==</span><span class="dv">1</span>,<span class="st">&#39;location&#39;</span>],</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>           prediction_catboost.loc[prediction_catboost.fault_severity<span class="op">==</span><span class="dv">1</span>].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>ax.scatter(prediction_catboost.loc[prediction_catboost.fault_severity<span class="op">==</span><span class="dv">2</span>,<span class="st">&#39;location&#39;</span>],</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>           prediction_catboost.loc[prediction_catboost.fault_severity<span class="op">==</span><span class="dv">2</span>].index, alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>ax.set_xlim((<span class="op">-</span><span class="dv">20</span>,<span class="dv">1150</span>))</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>ax.set_ylim((<span class="dv">0</span>,<span class="dv">11500</span>))</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Location&#39;</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;ID&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_b3edb5da3894434db562cb9f30f1cd61/f7880672310531c6ebfb0c4dbc6994c0113afd4c.png" /></p>
</div>
</div>
<section id="despliegue" class="cell markdown">
<h2>Despliegue</h2>
<hr />
</section>
<div class="cell markdown">
<p>En esta fase, evaluaremos el peso, o mas bien, la importancia de cada
una de las caracteristicas utilizadas para el entrenamiento de nuestro
modelo. Ya que, esto nos permitira ver que mas se requiere para poder
mejorar el modelo</p>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model.get_feature_importance()</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<pre><code>array([ 6.3250055 , 22.46957826, 11.11821714, 12.5966741 , 16.14897793,
       21.25928377, 10.08226331])</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Esta funcion nos da a conocer el porcentaje de relevancia de cada una
de las caracteristicas utilizadas. Donde:</p>
<ul>
<li>id = 6.32%</li>
<li>location = 22.50%</li>
<li>severity_type = 11.12%</li>
<li>resource_type = 12.60%</li>
<li>log_feature = 16.15%</li>
<li>volume = 21.26%</li>
<li>event_type = 10.08%</li>
</ul>
</div>
<div class="cell markdown">
<p>Estos resultados nos dan a conocer dos cosas:</p>
<ul>
<li><p>Primeramente, que la ubicacion si es el factor y la
caracteristica mas relevante de este proyecto. Por lo cual, Telstra
tendra que indagar e investigar sus nodos de conexiones fisicas. Para
poder determinar si hay perdidas de paquetes en la transmision de
informacion dada la decadencia en tramos largos de paquetes,
caracteristicas climaticas en ciertas regiones de australia.</p></li>
<li><p>Segundamente, los otros dos factores importantes del modelo
fueron; volumen y en especifico, log_feature. Log_feature, y volume,
existen en el mismo archivo, lo cual es un indicativo que van desde el
inicio, relacionados. Por igual, el detalle de log_feature nos logra
hacer entender que debe de exisitir algo mas haya que no logramos ver a
simple vista en este modelo. Algo que tenga que ver con el historial del
tiempo de cada uno de estos errores. Saber esto, nos podra permitir
conocer como mejorar el modelo y por ende, tenga un entrenamiento mas
duradero y de resultados mas precisos.</p></li>
</ul>
</div>
</body>
</html>
